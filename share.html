<html>
<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
	<title>StreetViewInvasion.js: Create & Share</title>
	<script src="http://maps.google.com/maps/api/js?sensor=false" type="text/javascript"></script>
	<script src="lib/prototype.js" type="text/javascript"></script>
	<script src="lib/scriptaculous.js" type="text/javascript"></script>
	<script src="PhiloGL.js" type="text/javascript"></script>
	<script src="StreetViewInvasion.js" type="text/javascript"></script>
	
	<script type="text/javascript">
		var SVI;
		var baseURL;
		
		function Initialize() {
			$('control').hide();
			
			SVI = new StreetViewInvasion("streetview");
			
			// parse query strings
			baseURL = String(window.location).split("?")[0];
			var query = String(window.location).toQueryParams();
			if(query.img) $('img').value = query.img;
			if(query.lat) $('lat').value = query.lat;
			if(query.lng) $('lng').value = query.lng;
			if(query.hd) $('hd').value = query.hd;
			if(query.pt) $('pt').value = query.pt;
			if(query.w) $('w').value = query.w;
			if(query.h) $('h').value = query.h;
			if(query.x) $('x').value = query.x;
			if(query.y) $('y').value = query.y;
			if(query.z) $('z').value = query.z;
			if(query.ps) $('ps').value = query.ps;
			if(query.th) $('th').value = query.th;
			if(query.ph) $('ph').value = query.ph;
			
			UpdateAll();
		}
		
		function UpdateImagePath() {
			SVI.setTexture($('img').value);
		}
		
		function UpdateImagePosition() {
			SVI.setFrameDegree(
				parseFloat($('w').value), 
				parseFloat($('h').value), 
				parseFloat($('x').value), 
				parseFloat($('y').value), 
				parseFloat($('z').value), 
				parseFloat($('ps').value), 
				parseFloat($('th').value), 
				parseFloat($('ph').value)
			);
		}
		
		function UpdateLocation() {
			SVI.setLocation(
				parseFloat($('lat').value), 
				parseFloat($('lng').value), 
				parseFloat($('hd').value), 
				parseFloat($('pt').value)
			);
		
		}
		
		function UpdateAll() {
			UpdateImagePath();
			UpdateImagePosition();
			UpdateLocation();
		}
		
		function CreateURL() {
			var pov = SVI.getPov();
			$('hd').value = pov.heading;
			$('pt').value = pov.pitch;
			
			$('share').value = baseURL + "?"
				+ "img=" + $('img').value + "&"
				+ "lat=" + $('lat').value + "&"
				+ "lng=" + $('lng').value + "&"
				+ "hd=" + $('hd').value + "&"
				+ "pt=" + $('pt').value + "&"
				+ "w=" + $('w').value + "&"
				+ "h=" + $('h').value + "&"
				+ "x=" + $('x').value + "&"
				+ "y=" + $('y').value + "&"
				+ "z=" + $('z').value + "&"
				+ "ps=" + $('ps').value + "&"
				+ "th=" + $('th').value + "&"
				+ "ph=" + $('ph').value;
		}
	</script>
	
	<style type="text/css">
		body {
			color: #333;
			font: 14px serif;
		}
		
		body a {
			color: #336;
		}
		
		#wrapper {
			width: 800px;
			margin: 20px auto;
		}
		
		#wrapper h1 {
			font-size: 20px;
		}
		
		#wrapper h1 a {
			color: #333;
		}
		
		#control h2 {
			font-size: 14px;
		}
		
		#control ul {
			list-style: none;
			padding: 0px;
		}
		
		#control input[type="text"] {
			border: 1px solid #666;
		}
		#control input[type="text"].long {
			width: 700px;
		}
		#control input[type="text"].short {
			width: 80px;
		}
		
		#control input[type="submit"] {
			border: 1px solid #666;
			width: 80px;
		}
		
		#footer {
			font: 11px sans-serif;
		}
	</style>
</head>

<body onload="Initialize();">
	<div id="wrapper">
		<div id="streetview" width="800px" height="450px"></div>
		
		<h1><a href="#" onclick="Effect.toggle('control', 'blind'); return false;">Edit</a></h1>
		<div id="control">
			<h2>Image URL</h2>
			<input type="text" id="img" class="long" name="img" value="http://www.woostercollective.com/images2/banksymus10.jpg" />
			<input type="submit" id="update" onclick="UpdateImagePath()" value="update" />
			
			<h2>Image Position</h2>
			<ul>
				<li>
					Width: <input type="text" id="w" class="short" name="w" value="9.5" />
					Height: <input type="text" id="h" class="short" name="h" value="7.0" />
				</li>
				<li>
					X: <input type="text" id="x" class="short" name="x" value="21.5" />
					Y: <input type="text" id="y" class="short" name="y" value="-3.8" />
					Z: <input type="text" id="z" class="short" name="z" value="20" />
					Roll: <input type="text" id="ps" class="short" name="ps" value="0" />
					Pitch: <input type="text" id="th" class="short" name="th" value="0" />
					Yaw: <input type="text" id="ph" class="short" name="ph" value="60" />
				</li>
			</ul>
			<input type="submit" id="update" onclick="UpdateImagePosition()" value="update" />
			
			<h2>Location & Camera</h2>
			<ul>
				<li>
					Latitude: <input type="text" id="lat" class="short" name="lat" value="40.761694" /> 
					Longitude: <input type="text" id="lng" class="short" name="lng" value="-73.977551" /> 
					Heading: <input type="text" id="hd" class="short" name="hd" value="32" /> 
					Pitch: <input type="text" id="pt" class="short" name="pt" value="-3" />
				</li>
			</ul>
			<input type="submit" id="update" onclick="UpdateLocation()" value="update" />
			
			<h2>Share</h2>
			<input type="text" id="share" class="long" name="share" value="" />
			<input type="submit" id="update" onclick="CreateURL()" value="create URL" />
		</div>
		<div id="info">
			<p>
			Tested on WebGL-enabled Firefox 4+ and Google Chrome 12+</br>
			More info: <a href="http://ysugano.github.com/StreetViewInvasion/">http://ysugano.github.com/StreetViewInvasion/</a>
			</p>
		</div>
		<div id="footer">
			<span><a href="http://ysugano.tumblr.com/">http://ysugano.tumblr.com/</a></span>
		</div>
	</div>
</body>

</html>